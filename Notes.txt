gcloud compute images describe-from-family IMAGE_FAMILY --project=PROJECT_ID --format="get(name)" --filter="status=READY" | grep -o 'projects/[^ ]*/global/images/[^ ]*' | awk -F '/' '{print $NF}'

gcloud secrets create "my-secret" \
    --replication-policy="user-managed" \ # user-managed requires locations
    --kms-key="projects/my-project/locations/us-central1/keyRings/my-keyring/cryptoKeys/my-key" \
    --project="my-project"


curl -k -s -H "Authorization: Bearer <YOUR_TOKEN>" \
     -H "Content-Type: application/json" \
     -X PATCH "https://<ANSIBLE_CONTROLLER>/api/v2/credentials/<CREDENTIAL_ID>/" \
     -d "{\"inputs\": {\"service_account_json\": $SA_JSON}}"


curl -k -X PATCH https://<TOWER_HOST>/api/v2/credentials/<CREDENTIAL_ID>/ \
    -H "Authorization: Bearer <TOKEN>" \
    -H "Content-Type: application/json" \
    -d '{
          "name": "Updated GCE Credential",
          "description": "Updated Google Compute Engine Credential",
          "inputs": {
              "username": "new-gce-user",
              "project": "your-gcp-project-id",
              "ssh_key_data": "your-ssh-private-key",
              "service_account_json": "your-updated-service-account-json"
          }
        }'
